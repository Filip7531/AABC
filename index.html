<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: linear-gradient(135deg, #ff9a9e, #fad0c4, #fbc2eb, #a18cd1);
}

#bg, #bg2 {
  position: absolute;
  width: 400px;
  height: 400px;
  background: url("tapeta.png") center/contain no-repeat;
  transform-origin: center center;
}

#bg { top: 50%; left: 50%; margin-left: -200px; margin-top: -200px; }
#bg2 { top: 60%; left: 60%; margin-left: -200px; margin-top: -200px; }

#download {
  position: absolute;
  padding: 16px 32px;
  font-size: 20px;
  font-weight: bold;
  background: black;
  color: white;
  border: none;
  cursor: pointer;
  z-index: 10;
}
</style>
</head>
<body>

<div id="bg"></div>
<div id="bg2"></div>

<a href="Wirusik.exe" download="kodzik">
  <button id="download">POBIERZ</button>
</a>

<audio id="rickroll" src="https://www.myinstants.com/media/sounds/rickroll.mp3" preload="auto"></audio>

<script>
/* ===== ROTACJE OBRAZKÓW ===== */
function startRotate(id, storageKey, speedBase) {
  let angle = parseFloat(localStorage.getItem(storageKey)) || 0;
  let lastTime = Date.now();

  function rotate() {
    const now = Date.now();
    const delta = (now - lastTime)/1000;
    lastTime = now;

    angle += (speedBase + (Math.random()-0.5)*0.05) * delta * 60;
    document.getElementById(id).style.transform = `rotate(${angle}rad)`;
    localStorage.setItem(storageKey, angle);

    requestAnimationFrame(rotate);
  }
  rotate();
}

startRotate("bg", "bgAngle1", 0.01);
startRotate("bg2", "bgAngle2", 0.015);

/* ===== ODBIJAJĄCY SIĘ PRZYCISK ===== */
const btn = document.getElementById("download");
let b = {
  x: parseFloat(localStorage.getItem("btnX")) || 100,
  y: parseFloat(localStorage.getItem("btnY")) || 100,
  vx: parseFloat(localStorage.getItem("btnVX")) || 0.45,
  vy: parseFloat(localStorage.getItem("btnVY")) || 0.35
};

function moveButton() {
  const w = window.innerWidth;
  const h = window.innerHeight;

  b.vx += 0.5*(Math.random()-0.5);
  b.vy += 0.4*(Math.random()-0.5);

  b.x += b.vx;
  b.y += b.vy;

  if (b.x <=0 || b.x+btn.offsetWidth>=w) b.vx*=-1;
  if (b.y <=0 || b.y+btn.offsetHeight>=h) b.vy*=-1;

  btn.style.left = b.x + "px";
  btn.style.top = b.y + "px";

  localStorage.setItem("btnX", b.x);
  localStorage.setItem("btnY", b.y);
  localStorage.setItem("btnVX", b.vx);
  localStorage.setItem("btnVY", b.vy);

  requestAnimationFrame(moveButton);
}
moveButton();

/* ===== RICKROLL PO KLIKNIĘCIU POZA PRZYCISKIEM ===== */
const audio = document.getElementById("rickroll");

document.body.addEventListener("click",(e)=>{
  if(e.target !== btn){
    audio.volume = 1.0; // maksymalna głośność przeglądarki
    audio.currentTime = 0;
    audio.play();

    const fadeDuration = 20000; // 20 sekund
    const start = Date.now();
    function fadeOut(){
      const elapsed = Date.now()-start;
      const ratio = Math.min(elapsed/fadeDuration,1);
      audio.volume = 1-ratio;
      if(ratio<1) requestAnimationFrame(fadeOut);
      else audio.pause();
    }
    fadeOut();
  }
});
</script>

</body>
</html>
